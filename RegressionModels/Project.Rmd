---
title: "Mileage Differences between Automatic and Manual Transmissions"
author: "T. Bennett"
date: "August 23, 2015"
output: pdf_document
---



Executive Summary
-----------------
This document describes an analysis of the U.S. National Oceanic and Atmospheric Administration (NOAA)'s Storm Events database from 1950 to November 2011.  The goals of the analysis were to assess the 1) population health and 2) economic impact of severe storm events.

As one might expect based on geography, the types of storm events in each U.S. state vary widely.  Government officials and planners need to account for local events in their use of this analysis. 
    
Heat events cause the most deaths and injuries per event.  Tropical depressions/storms and hurricanes cause nearly as many injuries per event, but fewer deaths.  

Overall, flood events cause the most property damage, and are close behind drought events in causing the most crop damage.  Tropical storms/depressions and hurricanes cause the most property and crop damage per storm event, and the second-most property damage overall, despite the fact that they are rare.  Other rainstorm and tornado events calso cause significant property damage, and winter storms also cause major crop damage.



Data Processing
---------------

```{r options, echo = FALSE}
options(dplyr.max_print = 10)
options(dplyr.min_print =  5)
```

  

1) Loading packages

```{r loadpackages, echo = TRUE, results="hide", message=FALSE}
library(dplyr)
library(ggplot2)
library(stringr)
library(xtable)
library(GGally)
```


2) Loading the raw data

```{r dataload, cache=TRUE}
## load and inspect the data 
data(mtcars)
str(mtcars)
glimpse(mtcars)
```


This analysis is based on the `mtcars` dataset included in the `datasets` package in base R. 
It contains data on the 1973-74 models of 32 different automobiles including fuel consumption
and 10 aspects of automobile design. Total 32 rows and 11 fields, no missing data.


  
Exploratory Data Analyses 
-------------------------

Miles per gallon is the primary outcome.

```{r eda1, cache=TRUE}
with(mtcars, boxplot(mpg, main = "Miles per gallon, overall"))
```

```{r labeltrtype, results = "asis"}
mtcars <- mtcars %>%
    mutate(trtype = factor(am, labels = c("Automatic", "Manual"))) %>%
    select(-am)
           
tab <- xtable(table(trtype))
tab
```

Transmission type is the primary predictor of interest. `r 13/32` have a manual transmission 
and `19/32` have a manual transmission.

```{r bivplot, cache=TRUE}
boxplot(mpg ~ trtype, main = "MPG, by transmission type", data = mtcars)
```

A bivariate plot does suggest that manual transmissions are associated with better
gas mileage. 
```{r ttest}
res <- t.test(mpg ~ trtype, var.equal=FALSE, data = mtcars)
```
A t-test of `mpg` using unequal variances bears that out: cars with automatic transmissions get `r res$estimate[1]` 
miles per gallon and cars with manual transmissions get `r res$estimate[2]` miles per gallon,
t-test _p_ = `r res$p.value`.



Potential Confounders
---------------------
  
Several other variables might confound the Transmission Type - Mileage relationship. 
Based on my working knowledge of automobile engines, any of the other 9 variables in 
the `mtcars` dataset might be hypothesized to be important. The below bivariate plots 
of the 9 variables against `mpg` suggest that any of them could reasonably 
be a predictor. 
```{r bivariateplots, cache = TRUE}
par(mfrow = c(3,3))
boxplot(mpg ~ cyl, main = "MPG, by # of Cylinders", data = mtcars, xlab = "Cylinders")
with(mtcars, plot(disp, mpg, main = "MPG, by Displacement", xlab = "Displacement (cubic in.)"))
with(mtcars, plot(hp, mpg, main = "MPG, by Horsepower", xlab = "Horsepower"))
with(mtcars, plot(drat, mpg, main = "MPG, by Rear Axle ratio", xlab = "Rear Axle Ratio"))
with(mtcars, plot(wt*1000, mpg, main = "MPG, by Vehicle Weight", xlab = "Weight (pounds)"))
with(mtcars, plot(qsec, mpg, main = "MPG, by 1/4 mile time", xlab = "1/4 mile time (seconds)"))
boxplot(mpg ~ gear, main = "MPG, by # of Forward Gears", data = mtcars, xlab = "Forward Gears")
boxplot(mpg ~ carb, main = "MPG, by # of Carburetors", data = mtcars, xlab = "Carburetors")
par(mfrow = c(1,1))
```


To avoid including two covariates that are highly correlated, I created the `pairs` plot below.
```{r pairsplot, cache = TRUE}
p <- ggpairs(mtcars, columns = 2:11, lower = list(continuous = "smooth"), params = c(method = "loess"))
p
```

Number of cylinders, horsepower, and displacement are highly correlated (which makes sense, I suppose).
I decided to include displacement in the model selection process and exclude the other two variables because 
displacement is a continuous variable that reflects a physical property of the car 
rather than a performance property of the car. Weight is also highly correlated with 
displacement, but not quite as highly correlated with the other two variables, so
I will consider weight during model selection.


Linear Regression including all potential predictors
----------------------------------------------------

```{r reg1, echo = FALSE}
mtcars <- mtcars %>%
    select(-hp, -cyl)   ### removing horsepower and number of cylinders per the above

fit <- lm(mpg ~ I(1 * (trtype == 'Manual')) + disp + drat + wt + qsec + vs + gear + carb, data = mtcars)
summary(fit)
```




Model Selection
---------------


  

  

  
  
 

  


  
  
  
  


  
  


  

  
 




